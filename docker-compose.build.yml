version: "3.5"
services:

  mysql:
    build:
      context: ./dockerfile/mysql/
      dockerfile: Dockerfile
    labels:
      - "com.khs1994.lnmp.app.env=development_self_build"

  # mariadb:
  #   # build:
  #   #   context: ./dockerfile/mariadb/
  #   #   dockerfile: Dockerfile
  #   labels:
  #     - "com.khs1994.lnmp.app.env=development_self_build"

  redis:
    build:
      context: ./dockerfile/redis/
      dockerfile: Dockerfile
    labels:
      - "com.khs1994.lnmp.app.env=development_self_build"

  php7:
    build:
      context: ./dockerfile/php/
      cache_from:
        - khs1994/php-fpm:latest-alpine3.7
      dockerfile: Dockerfile
      args:
        buildno: 1
        password: secret
      labels:
        com.khs1994.description: "Extend Official PHP_FPM Docker Image"
        com.khs1994.department: "Chinese"
        com.khs1994.label-with-empty-value: ""
    environment:
      - KHS1994_LNMP_DOCKER_VERSION=${KHS1994_LNMP_DOCKER_VERSION} x86_64 With Build Docker Image
    labels:
      - "com.khs1994.lnmp.app.env=development_self_build"

  # rabbitmq:
  #   build:
  #     context: ./dockerfile/rabbitmq/
  #     dockerfile: Dockerfile
  #   labels:
  #     - "com.khs1994.lnmp.app.env=development_self_build"
  #
  # postgresql:
  #   build:
  #     context: ./dockerfile/postgresql/
  #     dockerfile: Dockerfile
  #   labels:
  #     - "com.khs1994.lnmp.app.env=development_self_build"
  #
  # mongodb:
  #   build:
  #     context: ./dockerfile/mongodb/
  #     dockerfile: Dockerfile
  #   labels:
  #     - "com.khs1994.lnmp.app.env=development_self_build"

  nginx:
    build:
      context: ./dockerfile/nginx/
      dockerfile: Dockerfile
    labels:
      - "com.khs1994.lnmp.app.env=development_self_build"

  # apache:
  #   # build:
  #   #   context: ./dockerfile/apache/
  #   #   dockerfile: Dockerfile
  #  labels:
  #     - "com.khs1994.lnmp.app.env=self_build"

  phpmyadmin:
    build:
      context: ./dockerfile/phpmyadmin/
      dockerfile: Dockerfile
    labels:
      - "com.khs1994.lnmp.app.env=development_self_build"

volumes:
  phpmyadmin-data:
