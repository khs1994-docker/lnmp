#!/bin/bash
. .env
echo -e "$0\n"
LARAVEL_PATH=$1
CMD=$2
ARCH=`uname -m`

if [ $ARCH = "armv7l" ];then
  DOCKER_IMAGE=khs1994/arm32v7-php-fpm
  TAG=${KHS1994_LNMP_PHP_VERSION}
elif [ $ARCH = "aarch64" ]; then
  DOCKER_IMAGE=false
else
  DOCKER_IMAGE=khs1994/php-fpm
  TAG=${KHS1994_LNMP_PHP_VERSION}-alpine
fi

# if build image
# DOCKER_IMAGE=lnmp-php

if [ ${DOCKER_IMAGE} = "false" ];then
    echo -e "\n\033[32mINFO\033[0m  ${ARCH} 暂不支持"
else

echo -e  "\n\033[32mINFO\033[0m  在 ${DOCKER_IMAGE}:${TAG} 内 /app/${LARAVEL_PATH} 执行 php artisan ${CMD}" && echo -e  "\n\033[32mINFO\033[0m  以下为输出内容\n\n"


docker run --rm -it \
       -v $PWD/app/${LARAVEL_PATH}:/app \
       ${DOCKER_IMAGE}:${TAG} \
       php artisan ${CMD}
fi
